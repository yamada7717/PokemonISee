<div class="container flex-grow px-5 py-24 mt-24 mx-auto bg-white max-w-screen-md">
  <h2 class="text-3xl font-bold text-center mb-8">ポケモンパーティ登録</h2>
  <div class="text-center">
    <% flash.each do |key, message| %>
      <div class="p-4 mt-4 text-sm text-red-700 bg-red-100 rounded-lg dark:bg-red-200 dark:text-red-800 max-w-md mx-auto" role="alert">
        <span class="font-medium"><%= message %></span>
      </div>
    <% end %>
  </div>
  <div class="max-w-md mx-auto p-3">
    <h2 class="text-lg font-semibold mb-4">ポケモン検索</h2>
    <p class="text-gray-600 mb-4">検索欄にカタカナでポケモンの名前を入力してください。</p>
    <%= form_with url: new_build_pokemon_party_path, method: :get, local: true, class: "flex items-center space-x-2" do |form| %>
      <%= form.text_field :search, placeholder: "例：ピカチュウ", class: "form-input flex-1 mt-2 md:mt-0 rounded border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" %>
      <%= form.submit "検索", class: "mt-2 md:mt-0 btn bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-600 transition-colors duration-200" %>
    <% end %>
  </div>
  <% if @pokemon_parties.present? %>
    <div class="mt-6 p-4">
      <h3 class="text-xl font-semibold mb-4">検索結果</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <% @pokemon_parties.each do |pokemon_party| %>
          <div class="pokemon p-4 flex flex-col items-center">
            <% if pokemon_party.pokemon_image_url.present? %>
              <%= image_tag pokemon_party.pokemon_image_url, alt: pokemon_party.pokemon.japanese_name, class: "w-24 h-24 object-contain mb-4" %>
            <% end %>
            <h3 class="text-xl font-bold my-2"><%= pokemon_party.pokemon.japanese_name %></h3>
            <%= form_with model: [@build, pokemon_party], local: true, class: "w-full" do |form| %>
              <%= form.hidden_field :pokemon_id, value: pokemon_party.pokemon_id %>
              <%= form.hidden_field :pokemon_image_url, value: pokemon_party.pokemon_image_url %>
              <div class="mb-4">
                <%= form.label :item, 'もちもの', class: "block text-sm font-medium text-gray-700" %>
                <%= form.select :item_id, @items, { include_blank: true }, { class: "form-input py-1 px-1 mt-1 w-full rounded border-gray-300" } %>
              </div>
              <%= form.submit "ポケモンを追加", class: "btn bg-green-500 text-white font-bold py-2 px-4 rounded hover:bg-green-600 transition-colors duration-200 w-full" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
  <div class="text-center mt-10">
    <%= link_to '構築詳細ページに戻る', build_path(@build), class: "text-white bg-blue-500 hover:bg-blue-600 font-bold py-2 px-4 rounded transition-colors duration-200" %>
  </div>
</div>
